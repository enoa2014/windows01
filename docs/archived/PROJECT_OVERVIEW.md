# 患儿入住信息管理系统 - 项目概览

## 项目简介

患儿入住信息管理系统是一个基于 Electron 框架开发的 Windows 桌面应用程序，专为小家患儿入住信息的管理和维护而设计。系统提供了完整的数据导入、存储、查询和展示功能。

## 核心功能

### 📊 数据管理
- **Excel 数据导入**：支持复杂多层表头的 Excel 文件批量导入
- **智能字段映射**：自动识别并正确映射患者姓名、父母信息等字段
- **家庭信息解析**：准确解析包含姓名、电话、身份证的复合字段
- **智能去重**：基于姓名和身份证号的智能人员去重逻辑
- **本地存储**：使用 SQLite 数据库确保数据安全可靠
- **数据完整性**：通过外键约束和索引保证数据一致性

### 👥 人员管理
- **去重规则**：
  - 不同身份证号：视为不同人员  
  - 同名（无论是否有身份证）：视为同一人员
  - 自动补充身份证信息：如果同名人员后续提供身份证，系统自动更新

### 🖥️ 用户界面
- **响应式设计**：适配不同屏幕尺寸
- **多主题支持**：提供薄荷翡翠、星云薄暮等4种主题
- **无障碍设计**：支持键盘导航和屏幕阅读器
- **打印优化**：专门的打印样式设计

### 🔍 数据查询
- **实时搜索**：支持按姓名、诊断、籍贯搜索
- **多维筛选**：按性别、入住时间等条件筛选
- **排序功能**：支持按姓名、年龄、最近入住时间排序

## 技术架构

### 前端技术栈
- **框架**：Electron 28.0
- **UI**：HTML5 + TailwindCSS + JavaScript
- **主题系统**：CSS 变量 + 数据属性切换
- **字体**：Inter 字体系列

### 后端技术栈
- **运行时**：Node.js 22.17
- **数据库**：SQLite3 5.1.6
- **文件处理**：XLSX 0.18.5
- **进程通信**：Electron IPC

### 构建工具
- **打包**：Electron Builder 24.0
- **开发**：Electron Development Mode
- **测试**：Jest 29.0

## 系统架构

```
患儿入住信息管理系统
├── 主进程 (Main Process)
│   ├── 应用生命周期管理
│   ├── 窗口创建和管理
│   ├── IPC 通信处理
│   └── 系统集成功能
├── 渲染进程 (Renderer Process)
│   ├── 用户界面渲染
│   ├── 用户交互处理
│   ├── 数据展示逻辑
│   └── 主题切换管理
├── 数据层 (Data Layer)
│   ├── SQLite 数据库
│   ├── 数据模型定义
│   ├── 查询优化索引
│   └── 数据完整性约束
└── 服务层 (Service Layer)
    ├── 数据库管理服务
    ├── Excel 导入服务
    ├── 数据去重服务
    └── 文件操作服务
```

## 数据模型

### 核心实体
1. **人员表 (persons)**：存储去重后的唯一人员信息
2. **患儿档案表 (patient_profiles)**：患儿基本信息
3. **入住记录表 (check_in_records)**：历次入住记录
4. **医疗信息表 (medical_info)**：诊断和治疗信息
5. **家庭信息表 (family_info)**：家庭背景和联系方式

### 关系设计
- 一对一：persons ↔ patient_profiles
- 一对多：persons → check_in_records
- 一对多：persons → medical_info  
- 一对一：persons ↔ family_info

## 安全特性

### 数据安全
- **本地存储**：数据完全存储在本地，无网络传输风险
- **访问控制**：通过 Electron 安全机制限制权限
- **数据备份**：支持数据导出和备份功能

### 应用安全
- **Context Isolation**：启用上下文隔离防止代码注入
- **Node Integration**：禁用 Node.js 集成提高安全性
- **预加载脚本**：通过预加载脚本安全暴露 API

## 性能优化

### 前端优化
- **虚拟滚动**：大数据量时的性能保障
- **防抖搜索**：减少不必要的查询请求
- **懒加载**：按需加载详细信息
- **缓存策略**：本地状态和主题缓存

### 后端优化
- **索引优化**：针对常用查询建立索引
- **连接池**：复用数据库连接
- **批量操作**：Excel 导入时的批量插入
- **错误处理**：优雅的错误处理和恢复

## 兼容性

### 系统要求
- **操作系统**：Windows 7 及以上版本
- **内存**：最低 2GB RAM，推荐 4GB
- **磁盘空间**：安装包约 150MB，数据存储需额外空间
- **显示器**：最低分辨率 1024×768，推荐 1280×720 或更高

### 浏览器内核
- **Chromium**：基于最新 Chromium 内核
- **Web APIs**：支持现代 Web API 和 ES6+ 语法
- **GPU 加速**：支持硬件加速渲染

## 项目结构

```
app02/
├── src/                          # 源代码目录
│   ├── main.js                   # Electron 主进程入口
│   ├── preload.js                # 预加载脚本
│   ├── database/                 # 数据库相关
│   │   └── DatabaseManager.js    # 数据库管理器
│   ├── services/                 # 业务服务
│   │   └── ExcelImporter.js      # Excel 导入服务
│   └── renderer/                 # 渲染进程
│       ├── index.html            # 主页面
│       └── js/
│           └── app.js            # 前端应用逻辑
├── docs/                         # 项目文档
├── database-schema.sql           # 数据库架构
├── package.json                  # 项目配置
├── README.md                     # 项目说明
└── .gitignore                    # Git 忽略规则
```

## 开发环境

### 必需工具
- Node.js 16.0+
- npm 或 yarn
- Git
- VS Code (推荐)

### 推荐插件
- **VS Code Extensions**:
  - JavaScript (ES6) code snippets
  - SQLite Viewer
  - Tailwind CSS IntelliSense
  - Chinese (Simplified) Language Pack

### 调试工具
- **Chrome DevTools**：内置于 Electron
- **SQLite Browser**：数据库可视化工具
- **Electron DevTools**：Electron 专用调试工具

## 部署说明

### 开发环境部署
1. 克隆项目代码
2. 安装依赖：`npm install`
3. 启动开发模式：`npm run dev`

### 生产环境打包
1. 构建应用：`npm run build-win`
2. 生成安装包：位于 `dist/` 目录
3. 分发安装包给最终用户

### 自动更新机制
- 支持通过 Electron Builder 配置自动更新
- 可集成版本检查和增量更新功能
- 提供离线安装包作为备选方案

## 维护和支持

### 日志系统
- **应用日志**：记录关键操作和错误信息
- **数据库日志**：SQL 操作和性能监控
- **用户操作日志**：用户行为追踪（可选）

### 备份策略
- **自动备份**：定期备份数据库文件
- **手动导出**：支持用户主动导出数据
- **恢复机制**：从备份文件恢复数据

### 技术支持
- **错误报告**：内置错误报告机制
- **远程诊断**：支持远程技术支持
- **用户培训**：提供操作手册和视频教程

## 未来规划

### 短期目标
- 添加数据统计和报表功能
- 支持更多 Excel 格式和数据源
- 优化大数据量时的性能表现
- 增加数据导出格式（PDF、Word 等）

### 长期规划  
- 开发移动端应用（可选）
- 集成云存储和同步功能
- 添加多用户和权限管理
- 支持自定义字段和表单
- 集成第三方系统 API

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

---

*文档最后更新时间：2025年8月20日*  
*项目版本：v1.0.0*  
*文档版本：v1.0*