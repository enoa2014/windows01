# 患儿入住信息管理系统

一个基于 Electron 的 Windows 桌面应用，用于管理小家患儿入住信息。

## 功能特性

- ✅ **数据导入**：支持从 Excel 文件导入患儿信息
- ✅ **智能去重**：根据姓名和身份证号自动识别同一人员
- ✅ **列表展示**：合并显示同一人员的多次入住记录
- ✅ **详情查看**：查看完整的患儿档案和入住历史
- ✅ **数据搜索**：支持按姓名、诊断、籍贯搜索
- ✅ **本地存储**：使用 SQLite 数据库本地存储
- ✅ **多主题**：支持多种界面主题
- ✅ **打印导出**：支持打印和导出功能

## 技术架构

- **前端框架**：Electron + HTML + CSS + JavaScript
- **数据库**：SQLite3
- **UI框架**：TailwindCSS + 自定义CSS变量主题系统
- **Excel处理**：XLSX 库
- **构建工具**：Electron Builder

## 快速开始

### 环境要求

- Node.js 16.0 或更高版本
- Windows 7 或更高版本

### 安装依赖

```bash
npm install
```

### 开发模式运行

```bash
npm run dev
```

### 生产模式运行

```bash
npm start
```

### 打包构建

```bash
# 构建 Windows 版本
npm run build-win

# 构建所有平台版本
npm run build
```

## 项目结构

```
app02/
├── src/
│   ├── main.js                 # Electron 主进程
│   ├── preload.js             # 预加载脚本
│   ├── database/
│   │   └── DatabaseManager.js # 数据库管理
│   ├── services/
│   │   └── ExcelImporter.js   # Excel 导入服务
│   └── renderer/
│       ├── index.html         # 主界面
│       └── js/
│           └── app.js         # 前端应用逻辑
├── database-schema.sql        # 数据库架构
├── package.json              # 项目配置
└── README.md                 # 项目说明
```

## 数据格式要求

Excel 文件应包含以下列（支持中文表头）：

- 序号、姓名、性别、出生日期、籍贯、民族、身份证号
- 入住时间、入住人、就诊医院、医院诊断、医生姓名
- 症状详情、医治过程、后续治疗安排
- 家庭地址、父亲信息、母亲信息、其他监护人、家庭经济

## 人员去重规则

1. **不同身份证号**：算不同人员
2. **同名（无论是否有身份证）**：算同一人员
3. **智能补充**：同名人员后续提供身份证时，系统自动更新现有记录

## 使用说明

1. **数据导入**：点击顶部"导入Excel"按钮选择数据文件
2. **查看列表**：在主界面浏览所有患儿信息
3. **搜索筛选**：使用搜索框或筛选器查找特定患儿
4. **查看详情**：点击患儿卡片查看详细信息和入住历史
5. **打印导出**：在详情页可打印或导出患儿档案

## 快捷键

- `/` - 快速聚焦搜索框
- `F` - 聚焦性别筛选器
- `Enter/Space` - 打开选中的患儿详情

## 开发说明

### 主要模块

1. **DatabaseManager**：数据库操作和人员去重逻辑
2. **ExcelImporter**：Excel 文件解析和数据导入
3. **PatientApp**：前端应用主类，处理UI交互和数据展示

### 添加新功能

1. 在对应的服务类中添加业务逻辑
2. 在 `main.js` 中注册 IPC 处理器
3. 在 `preload.js` 中暴露安全的API
4. 在 `app.js` 中添加前端交互逻辑

## 许可证

MIT License

## 支持

如有问题或建议，请提交 Issue 或联系开发团队。